<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: test transition between graphs</title>
		<script type="text/javascript" src="./d3.v7.js"></script>
		<style type="text/css">
		
		</style>
	</head>
	<body>
		<h1 style="font-size:100px; color:gray; margin:10px;">Animation Test</h1>
		<button onclick="on_click_Button1()">Dataset 1</button>
		<button onclick="on_click_Button2()">Dataset 2</button>
		<button onclick="on_click_Button3()">Dataset 3</button>
		<p/>

		<script type="text/javascript">

			//setup
			var width = 500;
			var height = 400;

			var padding1 = 1;
			var dataset1 = [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13, 11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];		
			var dataset1_vuoto = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];

			var padding2 = 30;
      		var dataset2 = [
        					{x: 1, y: 7},
        					{x: 2, y: 6.5},
        					{x: 3, y: 6.8},
        					{x: 4, y: 7.4},
        					{x: 5, y: 8},
        					{x: 6, y: 7.5},
        					{x: 7, y: 8}
      					];      		
      		var dataset2_vuoto = [
        					{x: 1, y: 6},
        					{x: 2, y: 6},
        					{x: 3, y: 6},
        					{x: 4, y: 6},
        					{x: 5, y: 6},
        					{x: 6, y: 6},
        					{x: 7, y: 6}
      					];      		

			var padding3 = 30;
      		var dataset3 = [
        					{x: 1, y: 8},
        					{x: 2, y: 6.5},
        					{x: 3, y: 6.1},
        					{x: 4, y: 7},
        					{x: 5, y: 7.8},
        					{x: 6, y: 6.5},
        					{x: 7, y: 7.1}
      					];      		
      		var dataset3_vuoto = [
        					{x: 1, y: 6},
        					{x: 2, y: 6},
        					{x: 3, y: 6},
        					{x: 4, y: 6},
        					{x: 5, y: 6},
        					{x: 6, y: 6},
        					{x: 7, y: 6}
      					]; 			
			
			var svg = d3.select("body")
						.append("svg")
						.attr("width", width)
						.attr("height", height);

			//first chart - empty bars
			svg.selectAll("rect")
			   .data(dataset1_vuoto)
			   .enter()
			   .append("rect")
			   .attr("x", function(d, i) {
			  		return i * (width / dataset1_vuoto.length);
			   })
			   .attr("y", function(d) {
			   		return height - (d * 8);
			   })
			   .attr("width", width / dataset1_vuoto.length - padding1)
			   .attr("height", function(d) {
			   		return d * 8;
			   })
			   .attr("fill", function(d) {
					return "rgb(0, 0, " + Math.round(d * 10) + ")";
			   });;

			//second and third charts
		    var x = d3.scaleLinear().range([padding2, width - padding2 * 2]);
      		//x.domain([0, d3.max(dataset2, function(d) { return d.x }) ]);
      		x.domain([0, 0]);
      
      		var y = d3.scaleLinear().range([height - padding2, padding2]);
      		//y.domain([6, d3.max(dataset2, function(d) { return d.y }) ]);
      		y.domain([6, 6]);
      
			var xAxis = d3.axisBottom().scale(x);
      		svg.append("g")
        		.attr("transform", "translate(0," + (height-padding2) + ")")
        		.attr("class","myXaxis")
      		svg.selectAll(".myXaxis").call(xAxis).attr("opacity", 0);

		    var yAxis = d3.axisLeft().scale(y);
      		svg.append("g")
        		.attr("transform", "translate("+padding2+",0)")
        		.attr("class","myYaxis")
      		svg.selectAll(".myYaxis").call(yAxis).attr("opacity", 0);

      		svg.append("path")
         		.datum(dataset2_vuoto)
         		.attr("class","myLine")
         		.attr("d", d3.line()
            		.x(function(d) { return x(d.x); })
            		.y(function(d) { return y(d.y); }))
            	.attr("fill", "none")
            	.attr("stroke", "steelblue")
            	.attr("stroke-width", 3)
         		.attr("opacity", 0);

			//events
			function on_click_Button1() {
					//alert("first")

					svg.selectAll("rect")
			   		   .data(dataset1)
			   	 	   .transition("rect").duration(600)
			   		   .attr("x", function(d, i) {
			   				return i * (width / dataset1.length);
			   		   })
			    	   .attr("y", function(d) {
			   				return height - (d * 8);
			   		   })
			   		   .attr("width", width / dataset1.length - padding1)
			   		   .attr("height", function(d) {
			   				return d * 8;
			   		   })
			   		   .attr("fill", function(d) {
							return "rgb(0, 0, " + Math.round(d * 10) + ")";
			   		   });

					x.domain([0, 0]);
					y.domain([6, 6]);

					svg.selectAll(".myXaxis").transition("myXaxis").duration(600).attr("opacity", 0).call(d3.axisBottom().scale(x));
					svg.selectAll(".myYaxis").transition("myYaxis").duration(600).attr("opacity", 0).call(d3.axisLeft().scale(y));				

					svg.selectAll(".myLine")
        			   .datum(dataset2_vuoto)
         			   .transition("path")
         			   .duration(600)
         			   .attr("d", d3.line()
            				.x(function(d) { return x(d.x); })
            				.y(function(d) { return y(d.y); }))
            		   .attr("fill", "none")
            		   .attr("stroke", "steelblue")
            		   .attr("stroke-width", 3)
         			   .attr("opacity", 0);
     			   
			}

			function on_click_Button2() {
					//alert("second")

					svg.selectAll("rect")
					   .data(dataset1_vuoto)
					   .transition("rect").duration(600)
					   .attr("y", function(d) {
					   		return height - (d * 4);
					   })
					   .attr("height", function(d) {
					   		return d * 4;
					   })
					   .attr("fill", function(d) {
							return "rgb(0, 0, " + Math.round(d * 10) + ")";
					   });

					x.domain([0, d3.max(dataset2, function(d) { return d.x }) ]);
					y.domain([6, d3.max(dataset2, function(d) { return d.y }) ]);

					svg.selectAll(".myXaxis").transition("myXaxis").duration(600).attr("opacity", 1).call(d3.axisBottom().scale(x));
					svg.selectAll(".myYaxis").transition("myYaxis").duration(600).attr("opacity", 1).call(d3.axisLeft().scale(y));

		      		svg.selectAll(".myLine")
        			   .datum(dataset2)
         			   .transition("path")
         			   .duration(600)
         			   .attr("d", d3.line()
            				.x(function(d) { return x(d.x); })
            				.y(function(d) { return y(d.y); }))
            		   .attr("fill", "none")
            		   .attr("stroke", "steelblue")
            		   .attr("stroke-width", 3)
         			   .attr("opacity", 1);
        			   
				}

			function on_click_Button3() {
					//alert("third")

					svg.selectAll("rect")
					   .data(dataset1_vuoto)
					   .transition("rect").duration(600)
					   .attr("y", function(d) {
					   		return height - (d * 4);
					   })
					   .attr("height", function(d) {
					   		return d * 4;
					   })
					   .attr("fill", function(d) {
							return "rgb(0, 0, " + Math.round(d * 10) + ")";
					   });

					x.domain([0, d3.max(dataset2, function(d) { return d.x }) ]);
					y.domain([6, d3.max(dataset2, function(d) { return d.y }) ]);

					svg.selectAll(".myXaxis").transition("myXaxis").duration(600).attr("opacity", 1).call(d3.axisBottom().scale(x));
					svg.selectAll(".myYaxis").transition("myYaxis").duration(600).attr("opacity", 1).call(d3.axisLeft().scale(y));

		      		svg.selectAll(".myLine")
        			   .datum(dataset3)
         			   .transition("path")
         			   .duration(600)
         			   .attr("d", d3.line()
            				.x(function(d) { return x(d.x); })
            				.y(function(d) { return y(d.y); }))
            		   .attr("fill", "none")
            		   .attr("stroke", "steelblue")
            		   .attr("stroke-width", 3)
         			   .attr("opacity", 1);         			   
				}			
		</script>
	</body>
</html>
